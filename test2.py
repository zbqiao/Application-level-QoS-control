import numpy as np
import matplotlib
matplotlib.use('Agg') 
import matplotlib.pyplot as plt

M=2048                   # number of nodes
N=2048                  # number of Fourier coefficients

from pynfft import NFFT, Solver
values=[0.147096157074,0.154017925262,0.138963937759,0.144005060196,0.146216154099,0.137249946594,0.141187906265,0.145761013031,0.146104097366,0.118088960648,0.144395828247,0.141672134399,0.144524097443,0.143849849701,0.144977092743,0.144515037537,0.117181062698,0.155076026917,0.155213117599,0.154677152634,0.152109146118,0.152261972427,0.145887851715,0.147713899612,0.137257099152,0.145837783813,2.37956500053,0.155925035477,0.144227027893,0.144959211349,0.133088111877,0.127101182938,0.144004106522,0.132316827774,0.150494098663,0.148832082748,0.138980865479,0.131893873215,0.144629955292,0.148211956024,0.144919872284,0.142977952957,0.148508071899,0.124626874924,0.146584033966,0.130735874176,0.145081996918,0.124441146851,0.135690927505,0.150391817093,0.144853115082,0.141575098038,0.141834020615,0.138600111008,0.148686885834,0.146828889847,0.147638082504,0.141340970993,0.146145820618,0.136965990067,0.149508953094,0.149019002914,0.142060995102,0.152117967606,0.119853973389,0.144528865814,0.148257017136,0.157356023788,0.118175029755,0.118088960648,0.149988889694,2.37460803986,0.148329973221,0.145945072174,0.142338037491,0.134859085083,0.145553827286,0.141669034958,0.137109994888,0.146176099777,0.148879051208,0.140851020813,0.136761903763,0.143687963486,0.137338876724,0.141262054443,0.128167152405,0.136056900024,0.134286880493,0.150475978851,0.156074047089,0.143857955933,0.142922878265,0.143491983414,0.140290975571,0.152870893478,0.149645090103,0.11862206459,0.154294967651,0.150426149368,0.117401123047,0.141680955887,0.14781498909,0.145078897476,0.114879846573,0.14914894104,0.125330924988,0.14849615097,2.32714319229,0.135270118713,0.143219947815,0.148788928986,0.137073040009,0.127335071564,0.145313978195,0.145470142365,0.125388145447,0.145373106003,0.147444009781,0.135494947433,0.145352840424,0.12468290329,0.145967006683,0.138036966324,0.125252962112,0.139990091324,0.144033908844,0.119688987732,0.122454881668,0.145190954208,0.145632982254,0.140846967697,0.143326997757,0.134860038757,0.129289865494,0.144418001175,0.134579181671,0.147175073624,0.148856878281,0.1487429142,0.146600961685,0.152720928192,0.120690107346,0.147176980972,0.146198987961,0.138851881027,0.12718296051,0.144033908844,0.142430067062,0.148851156235,0.141409873962,0.13879108429,0.137544155121,0.118366003036,0.149010896683,2.63757300377,0.150526046753,0.144876003265,0.143550872803,0.144530057907,0.134476184845,0.141103982925,0.143377065659,0.140602827072,0.138911962509,0.147183895111,0.14858007431,0.148155927658,0.145846128464,0.144668102264,0.134839057922,0.142081022263,0.136819124222,0.144148826599,0.142761945724,0.145143985748,0.150418043137,0.146958112717,0.145639181137,0.158849000931,0.142174005508,0.145644903183,0.149490118027,0.142449140549,0.148992776871,0.143159151077,0.145426988602,0.149042129517,2.36096310616,0.14117193222,0.149477958679,0.139725923538,0.140700101852,0.136981964111,0.145132064819,0.147562026978,0.141550064087,0.137138843536,0.116186141968,0.142916202545,0.143173933029,0.146242141724,0.138150215149,0.141407012939,0.140695095062,0.12863779068,0.143354177475,0.144081115723,0.139686107635,0.123451948166,0.139299869537,0.140964031219,0.122622966766,0.145932912827,0.13658118248,0.093220949173,0.134166955948,0.147522926331,0.14871096611,0.117475032806,0.115259885788,0.152549982071,0.147413015366,0.139851808548,0.147619962692,0.140961170197,0.125143051147,0.144476890564,0.117980003357,0.145567893982,0.138633966446,0.149361133575,0.14688706398,2.34537887573,0.149084091187,0.146497964859,0.145615816116,0.143490076065,0.142326116562,0.146194219589,0.137236118317,0.143853187561,0.137020111084,0.143986940384,0.142029047012,0.142238140106,0.144073963165,0.139564990997,0.146349906921,0.146254062653,0.138908863068,0.139092922211,0.144767045975,0.142050981522,0.127400159836,0.135790109634,0.139892101288,0.145554065704,0.145406961441,0.151166915894,0.160490989685,0.160452127457,0.162636041641,0.147436141968,0.12134718895,0.147675037384,0.141167879105,0.1517329216,0.133910894394,0.14647603035,2.46479082108,0.140167951584,0.114543914795,0.145645141602,0.14640212059,0.14070391655,0.137857913971,0.118426084518,0.140136003494,0.14067196846,0.148775100708,0.138743162155,0.139436006546,0.147397994995,0.137511014938,0.145440816879,0.137373924255,0.138421058655,0.113739013672,0.106583118439,0.113881111145,0.104445934296,0.143784999847,0.112591028214,0.143935203552,0.110970020294,0.144559860229,0.139623880386,0.145267963409,0.15016412735,0.150645971298,0.152569770813,0.16416311264,0.157788991928,0.157636880875,0.135709047318,0.14873290062,0.137434005737,0.156944036484,0.152732133865,0.144361972809,0.118552923203,0.141668081284,0.129828929901,0.134644031525,2.42983603477,0.147590875626,0.143364906311,0.146384954453,0.147122859955,0.143458127975,0.145613193512,0.146226167679,0.144458055496,0.142817020416,0.145550012589,0.143060922623,0.145365953445,0.145642995834,0.146367073059,0.11533498764,0.141991138458,0.142245769501,0.146010160446,0.141331911087,0.115108966827,0.144608974457,0.112440109253,0.144429922104,0.1458568573,0.147515058517,0.145056962967,0.147223949432,0.147995948792,0.136172056198,0.148073911667,0.141973972321,0.149281978607,0.147400140762,0.157641887665,0.137751102448,0.145350933075,2.4590651989,0.12468290329,0.103110074997,0.144540786743,0.13500213623,0.143431901932,0.141537904739,0.187726974487,0.141814947128,0.149903059006,0.13481593132,0.1017370224,0.141116857529,0.124140977859,0.128787994385,0.143676042557,0.121407985687,0.131397008896,0.13906121254,0.144381046295,0.146435022354,0.129065990448,0.138810157776,0.14103603363,0.122977018356,0.140492916107,0.113364934921,0.129043102264,0.142761945724,0.148021936417,0.144016981125,0.113919019699,0.107524871826,0.108834028244,0.106544971466,0.10728597641,0.106922864914,0.106496095657,0.106421947479,0.107861042023,0.10333609581,0.156347990036,0.139883995056,0.138957023621,2.40896701813,0.142426967621,0.144705057144,0.119665145874,0.136579990387,0.137844085693,0.131204843521,0.146688938141,0.146074056625,0.143527984619,0.144579172134,0.144062995911,0.143815040588,0.138561964035,0.141680002213,0.144388914108,0.13301897049,0.137632846832,0.126080036163,0.132279872894,0.13769197464,0.147079944611,0.143056869507,0.138906955719,0.140840053558,0.121570825577,0.143986940384,0.143996953964,0.157850980759,0.146347045898,0.14296412468,0.145784854889,0.145555973053,0.145280838013,0.147211074829,0.131788015366,0.147790908813,0.147420883179,0.146003007889,0.128034830093,0.146706104279,0.155461072922,0.145153999329,0.150372982025,0.144754886627,0.142673015594,2.72159981728,0.142393112183,0.142819166183,0.143694162369,0.114404916763,0.143029928207,0.12030506134,0.119976043701,0.13996887207,0.117729902267,0.135755062103,0.138858795166,0.140671014786,0.134407997131,0.141407966614,0.126783847809,0.113940000534,0.147812843323,0.130954027176,0.145552158356,0.150707006454,0.145591974258,0.141952991486,0.142242908478,0.136720895767,0.146952867508,0.140074014664,0.158572912216,0.151219844818,0.135948181152,0.141522169113,0.14683508873,0.158415079117,0.161591053009,0.119663000107,0.143546104431,0.154318809509,0.135957956314,0.142966032028,0.144671916962,2.41020798683,0.146613836288,0.141647100449,0.139243841171,0.144716024399,0.142756223679,0.146255970001,0.146991014481,0.145468950272,0.145967006683,0.144080162048,0.13271689415,0.141105890274,0.145608901978,0.146068096161,0.125068902969,0.128711938858,0.142355918884,0.141322851181,0.144948959351,0.145497083664,0.118335008621,0.12784910202,0.141149044037,0.116474866867,0.144994974136,0.155385017395,0.143891811371,0.146816968918,0.143927097321,0.142550945282,0.146841049194,0.139358997345,0.152167081833,0.153169870377,0.162171840668,0.15293598175,0.139026165009,0.143180131912,0.117326974869,0.155871868134,2.32647585869,0.149066925049,0.128559827805,0.123641014099,0.144154071808,0.141852855682,0.142227888107,0.1253221035,0.138790130615,0.14393901825,0.142108201981,0.149147033691,0.138529062271,0.140545129776,0.148018121719,0.140558004379,0.143845081329,0.115198135376,0.103612184525,0.143914937973,0.134102106094,0.14199090004,0.140492916107,0.143869876862,0.146705150604,0.152044057846,0.147220134735,0.124820947647,0.13650393486,0.107120037079,0.153130054474,0.128894090652,0.149188995361,0.142009973526,0.165397882462,0.144634008408,0.113147974014,0.105479001999,0.107286930084,2.65605115891,0.136832952499,0.133823871613,0.11363697052,0.1448969841,0.130494832993,0.151777029037,0.1133852005,0.111078977585,0.146097898483,0.148869037628,0.155314922333,0.143858909607,0.125452041626,0.141315937042,0.118325948715,0.137261867523,0.143630981445,0.188295125961,0.140820026398,0.138118982315,0.146900892258,0.140675067902,0.139815092087,0.148801088333,0.201425075531,0.14653801918,0.123283147812,0.141554832458,0.13973903656,0.138352155685,0.145405054092,0.152578115463,0.147469997406,0.139097929001,0.135565042496,0.106438875198,0.141983985901,2.727039814,0.144414901733,0.148838996887,0.146152973175,0.143855810165,0.13423204422,0.12303185463,0.136074066162,0.113406181335,0.188914060593,0.145013093948,0.127043962479,0.13794708252,0.147770881653,0.123450994492,0.116250038147,0.146693944931,0.142238855362,0.141808986664,0.130377054214,0.136723041534,0.116655111313,0.139827013016,0.147841930389,0.147762060165,0.137650966644,0.112985134125,0.147519826889,0.146997928619,0.145869970322,0.150686979294,0.14704990387,0.13010597229,0.136073112488,0.145525217056,0.138556003571,0.121361017227,0.145884037018,0.143949985504,2.43505787849,0.142659902573,0.132826089859,0.145513057709,0.125412940979,0.139733076096,0.14545416832,0.138978004456,0.139595031738,0.112486839294,0.139260053635,0.112999916077,0.137845039368,0.127547979355,0.134160995483,0.142846107483,0.140775918961,0.11273598671,0.131130218506,0.135850191116,0.133366107941,0.126373052597,0.105612039566,0.133641004562,0.143895149231,0.136892080307,0.14945602417,0.140608072281,0.14616394043,0.132219076157,0.155987977982,0.161821126938,0.16298699379,0.144994020462,0.146270990372,0.12481379509,0.122159957886,0.149071931839,2.45740199089,0.145808935165,0.148448944092,0.14452791214,0.132865905762,0.143374919891,0.143387079239,0.115873098373,0.141577005386,0.143910169601,0.135207176208,0.143491029739,0.143903017044,0.140794038773,0.138667106628,0.121334075928,0.127753973007,0.14710187912,0.144661903381,0.153141975403,0.134592056274,0.149652957916,0.150108098984,0.143721103668,0.143493890762,0.116761922836,0.140624046326,0.139331817627,0.116217136383,0.118214130402,0.132191896439,0.140300035477,0.141714811325,0.139117002487,0.136547088623,0.13960313797,0.145128965378,0.154417991638,0.142359972,0.140241861343,0.142666101456,0.11910200119,0.154125928879,0.145817995071,0.144284009933,2.74476599693,0.147234201431,0.138613939285,0.139105081558,0.136698007584,0.128760099411,0.144474029541,0.148630857468,0.1391248703,0.14843416214,0.136993169785,0.14878320694,0.135028123856,0.133418083191,0.111655950546,0.143069982529,0.138878822327,0.138222932816,0.142338037491,0.126529932022,0.125577926636,0.142260789871,0.141112089157,0.151008844376,0.164211034775,0.137622833252,0.144644975662,0.122619152069,0.141119003296,0.146082878113,0.145221948624,0.148931026459,0.15310883522,0.144757986069,0.136847019196,0.10880112648,0.109678983688,0.108286142349,2.33273887634,0.155746936798,0.149788856506,0.12703704834,0.144818782806,0.117568969727,0.143857002258,0.140861034393,0.144108057022,0.145549058914,0.144018173218,0.127629995346,0.146445989609,0.142753839493,0.135004997253,0.148634910583,0.145451068878,0.120710849762,0.140388965607,0.136136054993,0.146008014679,0.146418094635,0.141137838364,0.14404296875,0.146781921387,0.136204004288,0.128165960312,0.14186000824,0.138204813004,0.153750896454,0.147685050964,0.147473096848,0.147543907166,0.142884969711,0.156935930252,0.163400888443,0.124431848526,0.144593000412,0.149873018265,0.143413066864,2.51665377617,0.145246982574,0.131133079529,0.140285015106,0.140089035034,0.130419015884,0.13810801506,0.131860971451,0.14301109314,0.147802114487,0.134919166565,0.144482135773,0.146127939224,0.144962072372,0.142091989517,0.132548809052,0.138864994049,0.12673997879,0.147526979446,0.140632152557,0.148338794708,0.146943092346,0.139397859573,0.144580841064,0.138386964798,0.148674964905,0.140717983246,0.148226976395,0.14939904213,0.145449876785,0.147119998932,0.148387908936,0.143647909164,0.131206989288,0.148879051208,0.146550178528,0.13290309906,0.131678104401,2.35741090775,0.146306037903,0.141261816025,0.144649028778,0.145469903946,0.144371986389,0.143126964569,0.137499094009,0.116348981857,0.147087097168,0.147047042847,0.140670061111,0.138309001923,0.146043777466,0.117942094803,0.143599033356,0.132749080658,0.143388986588,0.133074045181,0.153331041336,0.146826028824,0.144228219986,0.143723011017,0.14457988739,0.138575077057,0.144845962524,0.143144845963,0.109012126923,0.146567106247,0.140601873398,0.152271986008,0.146742105484,0.140733957291,0.138554096222,0.148499011993,0.145748138428,0.145133972168,0.146163225174,0.146473169327,0.133863925934,0.123867034912,0.144352197647,0.120315074921,0.148908853531,2.2845261097,0.141185998917,0.146085977554,0.148674964905,0.15106010437,0.136954069138,0.145125865936,0.140368938446,0.129263877869,0.144950151443,0.115126132965,0.134260177612,0.147662162781,0.145627975464,0.139060020447,0.151920080185,0.149053096771,0.138691186905,0.141051054001,0.148529052734,0.140421867371,0.150743961334,0.145051002502,0.139800071716,0.149108171463,0.152765035629,0.146955013275,0.14399600029,0.131316900253,0.144334077835,0.138565063477,0.145169973373,0.145323038101,0.146476984024,0.140868186951,0.148931980133,0.128131151199,0.147864103317,0.153417825699,2.57340407372,0.150859117508,0.142997980118,0.147973060608,0.143523931503,0.136084794998,0.112797021866,0.144446849823,0.144403934479,0.14145898819,0.144689798355,0.135422945023,0.137876987457,0.139600038528,0.143718957901,0.142034053802,0.147526025772,0.143737077713,0.141742944717,0.144312858582,0.137039899826,0.132525920868,0.131477117538,0.114681005478,0.146290063858,0.143335819244,0.146041870117,0.147639036179,0.149117946625,0.150996923447,0.148411989212,0.160020112991,0.16323018074,0.160867929459,0.133435964584,0.139824151993,0.159050941467,2.44001102448,0.146911144257,0.13892698288,0.134015083313,0.134321928024,0.123406887054,0.136981010437,0.126549959183,0.138944149017,0.115984916687,0.14421582222,0.144981861115,0.145333051682,0.145717859268,0.143733024597,0.139654159546,0.120630025864,0.139631032944,0.1412358284,0.137331008911,0.14365696907,0.14651799202,0.145218133926,0.138036966324,0.143787145615,0.136101961136,0.11416387558,0.120195865631,0.13929104805,0.136529922485,0.142721891403,0.140222072601,0.141225099564,0.148920059204,0.153585195541,0.15087890625,0.157527923584,0.148701906204,0.120759963989,0.122470140457,0.148340940475,0.146003007889,0.152426958084,2.29790902138,0.143166065216,0.153071165085,0.149570941925,0.14329791069,0.144745826721,0.146091938019,0.145420074463,0.146295070648,0.14532995224,0.121849060059,0.144563913345,0.127907991409,0.141806125641,0.144695997238,0.140574932098,0.144613981247,0.14582490921,0.13619184494,0.134333133698,0.140825033188,0.139224052429,0.14487695694,0.145462989807,0.13743686676,0.138846874237,0.116361141205,0.147581100464,0.154898881912,0.155112981796,0.166939020157,0.163250923157,0.157437086105,0.149417161942,0.142758846283,0.149043083191,0.146181106567,0.148905038834,0.148246049881,0.14053106308,0.149079084396,2.34843707085,0.147830963135,0.134588956833,0.151129961014,0.124262094498,0.140645027161,0.143632888794,0.139524936676,0.144536018372,0.141534805298,0.143154144287,0.147878170013,0.135348081589,0.144806861877,0.141588926315,0.140474081039,0.127694129944,0.136139154434,0.118503093719,0.144999027252,0.130619049072,0.143309831619,0.141717910767,0.146132946014,0.131878137589,0.138750076294,0.140087842941,0.136132955551,0.145617961884,0.161237955093,0.157368183136,0.153409957886,0.164052009583,0.142091989517,0.141144990921,0.145183086395,0.145225048065,0.147840976715,0.14860200882,0.145174980164,2.34233784676,0.145168066025,0.130505084991,0.136848211288,0.140460014343,0.134141921997,0.13986992836,0.140589952469,0.130404949188,0.143771886826,0.135742902756,0.138803005219,0.124938011169,0.143280982971,0.147866010666,0.144242048264,0.122555971146,0.147880077362,0.138796806335,0.182417154312,0.146037101746,0.114467859268,0.135595083237,0.146054983139,0.141027927399,0.137055158615,0.138694047928,0.136747837067,0.147616147995,0.14648103714,0.147563934326,0.134486913681,0.133769035339,0.14449596405,0.154364824295,0.145601987839,0.14816904068,0.139986038208,0.149031877518,0.143589019775,2.39660906792,0.143848896027,0.144986867905,0.148761987686,0.117560863495,0.135351896286,0.114478111267,0.186314105988,0.146862983704,0.147536039352,0.136030912399,0.133194923401,0.137866973877,0.113537073135,0.137359857559,0.141093969345,0.146020889282,0.131010055542,0.1443400383,0.138962030411,0.144326925278,0.141901016235,0.125771045685,0.123716831207,0.143712043762,0.145144224167,0.139719009399,0.138562917709,0.143458127975,0.114323139191,0.14219379425,0.132004022598,0.14482998848,0.200546979904,0.142165899277,0.132970094681,0.114487886429,0.151233911514,0.129695892334,0.146086931229,0.1511490345,0.116564035416,2.36667108536,0.151756048203,0.144418954849,0.145115852356,0.140884160995,0.139115095139,0.139144897461,0.116402864456,0.144232988358,0.14137005806,0.138149023056,0.145020961761,0.114930868149,0.13801407814,0.147836208344,0.13769197464,0.143826961517,0.136853933334,0.1445748806,0.136268138885,0.114920139313,0.150557994843,0.136036157608,0.149445056915,0.140284061432,0.14232301712,0.135535001755,0.140153884888,0.151011943817,0.157877922058,0.156047821045,0.160599946976,0.163342952728,0.139933109283,0.148829936981,0.147820949554,0.134990930557,0.15035200119,0.139723062515,0.124480009079,0.154125928879,2.33398294449,0.1482629776,0.147786855698,0.135874986649,0.144715070724,0.142501115799,0.145375967026,0.143681049347,0.136743068695,0.144155979156,0.139622926712,0.134549856186,0.139430046082,0.142903804779,0.145107984543,0.146507024765,0.141851902008,0.138073921204,0.138773918152,0.111838102341,0.128528118134,0.148131132126,0.14456486702,0.140800952911,0.142461061478,0.139588117599,0.13382101059,0.14684009552,0.144870996475,0.142915010452,0.141898870468,0.147953033447,0.163380861282,0.13446688652,0.127705812454,0.119951963425,0.151554107666,0.141799926758,0.141954898834,0.148086071014,0.175825119019,2.34146904945,0.141486883163,0.13650894165,0.133196115494,0.134948968887,0.143064022064,0.125597953796,0.135331869125,0.142855882645,0.143645048141,0.138727903366,0.140131950378,0.141429901123,0.148886919022,0.14252614975,0.138279914856,0.140351057053,0.137764930725,0.144927024841,0.142636060715,0.141852855682,0.142554998398,0.149736881256,0.141906023026,0.136961936951,0.111028909683,0.146291971207,0.121178865433,0.131647109985,0.150825023651,0.124111890793,0.14191198349,0.134348154068,0.153370141983,0.142468214035,0.128793001175,0.149640083313,0.155011177063,0.131599903107,0.150371074677,0.138914108276,2.38758206367,0.135488986969,0.145757913589,0.141405820847,0.146826028824,0.144422054291,0.145055055618,0.143395900726,0.145354986191,0.149761915207,0.130703926086,0.144935131073,0.141678094864,0.13960814476,0.119851827621,0.147464036942,0.136541843414,0.142117023468,0.146538972855,0.132941961288,0.145116090775,0.144162893295,0.134479045868,0.149544000626,0.14325594902,0.139087915421,0.13764500618,0.134130001068,0.151636838913,0.14656496048,0.118450880051,0.151650905609,0.141093969345,0.14816904068,0.146687984467,0.139002084732,0.154417037964,0.147842168808,0.144708156586,0.107800960541,0.105268001556,2.39862203598,0.145630121231,0.14015007019,0.112957000732,0.1115629673,0.139535188675,0.120403051376,0.140027999878,0.145267963409,0.136013031006,0.142242908478,0.132755994797,0.139750957489,0.14169383049,0.144949913025,0.12616109848,0.14333486557,0.146471977234,0.115137815475,0.1139960289,0.133594989777,0.112282037735,0.113445043564,0.112075805664,0.144373178482,0.155585050583,0.113041877747,0.150531053543,0.146842956543,0.14939904213,0.141244888306,0.148249149323,0.147216081619,0.146166086197,0.14764213562,0.145308971405,0.136914014816,0.146915912628,0.143127918243,0.119474887848,0.134131908417,0.148190021515,0.152791976929,0.145575046539,2.36296987534,0.1570520401,0.139319896698,0.13591003418,0.148555994034,0.143118143082,0.144406080246,0.113564968109,0.144023180008,0.123893022537,0.124407052994,0.116575956345,0.150289058685,0.148730039597,0.140760183334,0.138062000275,0.143239021301,0.147185087204,0.133485078812,0.139270067215,0.143957138062,0.14319396019,0.139157056808,0.11962890625,0.145026922226,0.140318870544,0.141638994217,0.152431964874,0.13848900795,0.157845020294,0.158648014069,0.146818876266,0.164087057114,0.120820999146,0.145968914032,0.146244049072,0.146054983139,0.116883039474,0.147224903107,0.146176815033,0.152579069138,0.153300046921,2.48044109344,0.147675037384,0.130231142044,0.1424908638,0.145048856735,0.138520956039,0.138967037201,0.14315199852,0.117733001709,0.144995927811,0.136948108673,0.114061117172,0.145097970963,0.144832849503,0.141309022903,0.125185012817,0.144656896591,0.144278049469,0.146585941315,0.148020029068,0.144609928131,0.144487142563,0.146847963333,0.147849082947,0.141181945801,0.147140979767,0.142601013184,0.147140026093,0.145744085312,0.132626056671,0.150762081146,0.168464183807,0.147175073624,0.151500940323,0.154480934143,0.144666194916,2.35879206657,0.156165122986,0.143881082535,0.116525888443,0.150621891022,0.143228054047,0.119365930557,0.152673959732,0.147371053696,0.138477087021,0.148616075516,0.146807909012,0.154194831848,0.139140129089,0.146800994873,0.145450115204,0.145888805389,0.135478973389,0.133502006531,0.144883871078,0.14222407341,0.134573936462,0.151959896088,0.144706964493,0.144070863724,0.14727306366,0.11647105217,0.131323099136,0.15198802948,0.150561094284,0.147765874863,0.149476051331,0.140284061432,0.153382062912,0.142822980881,0.14714717865,0.170387029648,0.117513895035,0.145354032516,0.131285905838,2.38616204262,0.146120071411,0.139272928238,0.140370845795,0.148428916931,0.148952007294,0.144160985947,0.145493030548,0.127873897552,0.136369943619,0.145472049713,0.144687891006,0.138411045074,0.137830972672,0.140963792801,0.141509056091,0.14249920845,0.143247127533,0.147371053696,0.131051063538,0.148650169373,0.133282184601,0.140328168869,0.131705999374,0.1119389534,0.111807823181,0.114418029785,0.113353013992,0.126866102219,0.144090890884,0.146529912949,0.120735168457,0.155158042908,0.166327953339,0.144590854645,0.152272939682,0.141726970673,0.143436193466,0.160624027252,0.162356138229,0.133160114288,0.116634845734,0.139064073563,0.150578975677,0.130400896072,2.46874094009,0.138318061829,0.144819021225,0.149481058121,0.14631986618,0.137741088867,0.142436027527,0.145859956741,0.137953042984,0.143173933029,0.141238927841,0.145044803619,0.148925065994,0.128047943115,0.145188808441,0.144015073776,0.147083997726,0.144205093384,0.146088838577,0.144643068314,0.116761922836,0.145221948624,0.117030858994,0.147673845291,0.137768030167,0.147119998932,0.148319005966,0.125406980515,0.144448041916,0.143764019012,0.143993854523,0.151861190796,0.144037008286,0.151634931564,0.150934934616,0.132641077042,0.143097162247,2.38926815987,0.146282911301,0.152410984039,0.13102889061,0.143429994583,0.116069078445,0.141340017319,0.143238067627,0.141628980637,0.140509843826,0.140568971634,0.135282039642,0.142103910446,0.144728899002,0.14776301384,0.141998052597,0.13907289505,0.142177820206,0.145107984543,0.146031856537,0.140574932098,0.138158082962,0.145406961441,0.14208984375,0.145848035812,0.134707927704,0.143565893173,0.142894983292,0.146280050278,0.147411108017,0.146323204041,0.148030996323,0.140422105789,0.14254617691,0.149983167648,0.146979093552,0.147179841995,0.147803068161,0.147150039673,0.15161895752,2.63435697556,0.142518997192,0.147253036499,0.142417907715,0.147789955139,0.143101930618,0.13910484314,0.147248029709,0.144240856171,0.143431901932,0.190129041672,0.142034053802,0.123261928558,0.126780986786,0.142332792282,0.139561891556,0.132362127304,0.136286973953,0.144927024841,0.137749195099,0.145421028137,0.140181064606,0.146070957184,0.129818916321,0.131395101547,0.144737005234,0.133183956146,0.146255016327,0.117051839828,0.149995088577,0.113761901855,0.136543035507,0.14191699028,0.140918970108,0.147514104843,0.131823062897,0.142658948898,0.136947870255,0.146603107452,0.131837844849,2.41392803192,0.147922992706,0.139277935028,0.141484975815,0.13849902153,0.148573875427,0.142749071121,0.134508132935,0.141886949539,0.137241840363,0.112240076065,0.139847040176,0.126661777496,0.130795001984,0.148870944977,0.146646022797,0.140777826309,0.144598960876,0.140650987625,0.126770973206,0.144445180893,0.146445035934,0.137139081955,0.1400141716,0.13756608963,0.141528844833,0.132396936417,0.143305063248,0.150371074677,0.146713018417,0.14163517952,0.14849114418,0.143875837326,0.116095066071,0.153369188309,0.145020008087,0.145452022552,0.142786979675,0.147203922272,0.19011092186,0.149066209793,0.137328147888,0.149116039276,2.3001730442,0.136914014816,0.134163856506,0.148902893066,0.145500898361,0.144843101501,0.128269910812,0.141634941101,0.140954017639,0.14158987999,0.133650064468,0.145617961884,0.133293867111,0.134040117264,0.14547419548,0.119709968567,0.145473957062,0.138742923737,0.115297079086,0.138121128082,0.113648176193,0.111612081528,0.149646043777,0.135662078857,0.131357908249,0.148547887802,0.12667298317,0.147937059402,0.145365953445,0.146726846695,0.147356987,0.158123970032,0.143203020096,0.147555828094,0.145316123962,0.180461168289,0.130297899246,0.147729873657,2.48669290543,0.152203083038,0.143142938614,0.136434793472,0.146196126938,0.125841140747,0.117266178131,0.140516996384,0.146988868713,0.120389938354,0.154588937759,0.144892930984,0.119936943054,0.145978927612,0.144989967346,0.122894048691,0.144292831421,0.137887001038,0.143963813782,0.144481897354,0.130808115005,0.144535064697,0.146762132645,0.141973018646,0.145657062531,0.135653972626,0.146923780441,0.141232013702,0.146526098251,0.154290914536,0.154794931412,0.163646936417,0.160971879959,0.163898944855,0.146254062653,0.118280887604,0.147746086121,0.146862030029,0.150618076324,0.163733005524,2.32738399506,0.145895957947,0.148121833801,0.140763044357,0.131735801697,0.138747930527,0.113880872726,0.146604061127,0.143643856049,0.147253990173,0.137411832809,0.142870903015,0.182057142258,0.145431041718,0.12084197998,0.144758939743,0.137811899185,0.145052909851,0.153338909149,0.135843992233,0.192406892776,0.14474606514,0.146388053894,0.145144939423,0.146374940872,0.157161951065,0.138879060745,0.142037153244,0.155904054642,0.16144490242,0.169790029526,0.158918142319,0.154773950577,0.153649091721,0.129624128342,0.147220849991,0.14356803894,0.147219181061,0.11644411087,0.143660783768,2.50005292892,0.14112496376,0.13339805603,0.147248983383,0.105684041977,0.141563892365,0.139096975327,0.150342941284,0.124804019928,0.136534929276,0.146234035492,0.144113063812,0.135232925415,0.14112496376,0.141360998154,0.131020069122,0.129757881165,0.118103981018,0.140096902847,0.115828990936,0.147383213043,0.132742166519,0.138967990875,0.141587972641,0.130326986313,0.137594938278,0.111770153046,0.148764133453,0.131119966507,0.15242099762,0.153045892715,0.112976074219,0.139982938766,0.151507139206,0.145984888077,0.146328926086,0.144093036652,0.140846967697,0.138627052307,0.133591890335,0.148584127426,0.150259971619,2.41251301765,0.138131856918,0.114717960358,0.151093959808,0.147177934647,0.137006044388,0.137284994125,0.143861055374,0.143542051315,0.118698120117,0.143725156784,0.143754959106,0.121875047684,0.144025087357,0.143737077713,0.139888048172,0.145190000534,0.136334180832,0.138847112656,0.138394117355,0.144745826721,0.14223408699,0.133944988251,0.141422986984,0.140057086945,0.127436876297,0.145006895065,0.154805898666,0.142328977585,0.140473127365,0.15616607666,0.141619920731,0.152833223343,0.154188156128,0.147370100021,0.143873929977,0.151323080063,0.141370773315,0.143496990204,2.38840293884,0.147161006927,0.147003173828,0.143681049347,0.140275001526,0.14692401886,0.141960144043,0.14803814888,0.144082784653,0.137125015259,0.122607946396,0.14116692543,0.146585941315,0.148128032684,0.141617059708,0.14064002037,0.139813899994,0.143918037415,0.11961722374,0.143743038177,0.137126922607,0.143811941147,0.145568847656,0.132183074951,0.113096952438,0.15050983429,0.141388893127,0.135226011276,0.139935970306,0.151963949203,0.140372037888,0.135560035706,0.142899036407,0.141791820526,0.1549680233,0.145356178284,0.145344018936,0.157050132751,0.133862018585,0.139316797256,0.150252103806,0.139580965042,0.14505815506,2.41914010048,0.146854877472,0.134682893753,0.139206171036,0.127685785294,0.143820047379,0.13719201088,0.150390863419,0.154603004456,0.143095016479,0.130323886871,0.143813848495,0.143826961517,0.118279933929,0.148724794388,0.143569946289,0.139225006104,0.137572050095,0.111522912979,0.143064022064,0.143291950226,0.144104003906,0.139966964722,0.121573925018,0.153007030487,0.116461992264,0.137358188629,0.133713006973,0.150552034378,0.147963047028,0.128451824188,0.117641925812,0.155514001846,0.165951967239,0.116959095001,0.147457122803,0.120332956314,0.147467851639,0.124329090118,2.40502500534,0.143254995346,0.132911920547,0.144824981689,0.142515897751,0.151641845703,0.139415979385,0.143034934998,0.146966934204,0.152310848236,0.144814968109,0.140370845795,0.128466129303,0.141119003296,0.148275136948,0.143183946609,0.142626047134,0.123070955276,0.142153978348,0.136977910995,0.145745992661,0.138367891312,0.137717008591,0.15333199501,0.141825199127,0.144983053207,0.139771938324,0.140716075897,0.136522054672,0.152257919312,0.141702890396,0.117274045944,0.142288923264,0.148082971573,0.145449876785,0.141696929932,0.139353990555,0.146941184998,0.130091190338,0.154489040375,2.44089007378,0.143402814865,0.147261142731,0.154906988144,0.140279054642,0.144573926926,0.140182971954,0.140223026276,0.115703105927,0.129317045212,0.133360862732,0.136173963547,0.139277935028,0.145071983337,0.145794868469,0.139830112457,0.136574029922,0.149488925934,0.142547130585,0.149368047714,0.140918970108,0.146507978439,0.146275997162,0.141250133514,0.143038988113,0.147319078445,0.136215925217,0.129893064499,0.130261182785,0.115855932236,0.149105787277,0.14138007164]
print len(values)
#ipylab inline --no-import-all 
nodes=[]
x1=0
for i in values:
    x1+=i
    nodes.append(x1)

values-=np.mean(values)
f     = np.empty(M,     dtype=np.complex128)
f_hat = np.empty([N,N], dtype=np.complex128)

this_nfft = NFFT(N=[N,N], M=M)
this_nfft.x = np.array([[node_i,0.] for node_i in nodes])
this_nfft.precompute()

this_nfft.f = f
ret2=this_nfft.adjoint()

print this_nfft.M  # number of nodes, complex typed
print this_nfft.N  # number of Fourier coefficients, complex typed
#print this_nfft.x # nodes in [-0.5, 0.5), float typed


this_solver = Solver(this_nfft)
this_solver.y = np.array(values)          # '''right hand side, samples.'''

#this_solver.f_hat_iter = f_hat # assign arbitrary initial solution guess, default is 0

this_solver.before_loop()       # initialize solver internals
#print this_solver.r_iter
#while not np.all(this_solver.r_iter < 1e-2):
#    print "bobo\n"
#    this_solver.loop_one_step()
niter = 1
for iiter in range(niter):
    this_solver.loop_one_step()

fig=plt.figure(1,(20,5))
ax =fig.add_subplot(111)

foo=[ np.abs( this_solver.f_hat_iter[i][0])**2 for i in range(len(this_solver.f_hat_iter) ) ]
foo_x=np.abs(np.arange(-N/2,+N/2,1))
print len(foo)
ax.plot(foo_x[:256],foo[:256])

plt.savefig('test1.pdf', format='pdf',bbox_inches='tight')

#for i in range(len(foo)):
#    if foo[i]>4*1e-9:
#        print "period =",1/foo_x[i] 
